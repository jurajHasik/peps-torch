

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>config &mdash; peps-torch alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> peps-torch
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ipeps.html">iPEPS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps.html">Generic iPEPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_kagome.html">Kagome iPEPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_c4v.html">1-site C4v iPEPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_lc_1site_pg.html">1-site iPEPS from lin. combination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipess_kagome.html">Generic Kagome iPESS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipess_kagome_pg.html">Kagome iPESS with point groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipess_kagome_pg_lc.html">Kagome iPESS from lin. combination</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ipeps.html#abelian-symmetric-ipeps">Abelian-symmetric iPEPS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_abelian.html">Generic  abelian-symmetric iPEPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_abelian.html#generic-abelian-symmetric-ipeps-with-weights">Generic abelian-symmetric iPEPS with weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_kagome_abelian.html">Abelian-symmetric Kagome iPEPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipeps_abelian_c4v.html">Abelian-symmetric 1-site C4v iPEPS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipeps/ipess_kagome_abelian.html">Abelian-symmetric generic Kagome iPESS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../envs.html">Environments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../envs/generic.html">Generic iPEPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/env.html">Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/ctmrg.html">Corner Transfer Matrix Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/ctm_projectors.html">Projectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/ctm_components.html">Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/rdm.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/rdm.html#module-ctm.pess_kagome.rdm_kagome">Specific RDMs for Kagome iPEPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/corrf.html">Correlation functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic/transfer_matrix.html">Transfer Matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../envs/generic_abelian.html">Abelian-symmetric generic iPEPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic_abelian/env_abelian.html">Abelian-symmetric environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic_abelian/ctmrg.html">Corner Transfer Matrix Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic_abelian/ctm_projectors.html">Projectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic_abelian/ctm_components.html">Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic_abelian/rdm.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/generic_abelian/rdm.html#module-ctm.pess_kagome_abelian.rdm_kagome">Specific RDMs for Kagome iPEPS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../envs/one_site_c4v.html">1-site C4v iPEPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v/env_c4v.html">1-site C4v Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v/ctmrg_c4v.html">Corner Transfer Matrix Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v/rdm_c4v.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v/transfer_matrix.html">Transfer Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v/corrf_c4v.html">Correlation functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../envs/one_site_c4v_abelian.html">Abelian-symmetric 1-site C4v iPEPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v_abelian/env_c4v_abelian.html">Abelian-symmetric 1-site C4v Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v_abelian/ctmrg_c4v_abelian.html">Corner Transfer Matrix Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v_abelian/rdm_c4v_abelian.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../envs/one_site_c4v_abelian/corrf_c4v_abelian.html">Correlation functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../optim.html">Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../optim/drivers.html">Optimization drivers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../optim/drivers/ad_optim.html">ad_optim</a></li>
<li class="toctree-l3"><a class="reference internal" href="../optim/drivers/ad_optim_lbfgs_mod.html">ad_optim_lbfgs_mod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../optim/drivers/ad_optim_sgd_mod.html">ad_optim_sgd_mod</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../optim/optimizers.html">Custom optimizers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../optim/optimizers/lbfgs_modified.html">Extended LBFGS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../optim/optimizers/sgd_modified.html">SGD with linesearch</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../config.html#main">Main</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#global">Global</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#corner-transfer-matrix-algorithm">Corner Transfer Matrix Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html#optimization">Optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/akltS2.html">Spin S=2 AKLT Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/akltS2.html#module-models.akltS2">2x1 and 2x2 unit cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/akltS2.html#x1-c4v">1x1 C4v</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/coupledLadders.html">Coupled Ladders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/coupledLadders.html#dense-pytorch">Dense (PyTorch)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/coupledLadders.html#dense-yast">Dense (YAST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/coupledLadders.html#with-explict-u-1-symmetry">With explict U(1) symmetry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/ising.html">Transverse Field Ising Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/ising.html#x1-unit-cell">1x1 unit cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/ising.html#x1-c4v">1x1 C4v</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/j1j2.html">J1-J2-J3 and J1-J2-lambda Heisenberg Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/j1j2.html#from-2x1-to-4x2-unit-cell-pytorch">from 2x1 to 4x2 unit cell (PyTorch)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/j1j2.html#from-2x1-to-4x2-unit-cell-dense-yast">from 2x1 to 4x2 unit cell (dense YAST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/j1j2.html#x1-c4v-pytorch">1x1 C4v (PyTorch)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/j1j2.html#x1-c4v-dense-yast">1x1 C4v (dense YAST)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/jq.html">J-Q Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/jq.html#module-models.jq">2x2 unit cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/jq.html#x1-c4v">1x1 C4v</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/spin_half_kagome.html">SU(2) model on Kagome lattice</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/spin_half_kagome.html#dense">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/spin_half_kagome.html#with-explict-u-1-symmetry">With explict U(1) symmetry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/su3_kagome.html">SU(3) model on Kagome lattice</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/su3_kagome.html#dense">Dense</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/su3_kagome.html#with-explict-u-1-xu-1-symmetry">With explict U(1)xU(1) symmetry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../groups.html">Groups</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../groups/pg.html">Point group: square lattice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../groups/su2.html">SU(2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../groups/su2.html#module-groups.su2_abelian">SU(2) with explicit U(1) structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../groups/su3.html">SU(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../groups/su3.html#su-3-with-explicit-u-1-xu-1-structure">SU(3) with explicit U(1)xU(1) structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../linalg.html">Linear Algebra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../linalg/custom_eig.html">Truncated eigendecomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/custom_svd.html">Truncated SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linalg/spec_decomp.html">Spectral decompositions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../linalg/spec_decomp.html#module-linalg.svd_gesdd">SVD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../linalg/spec_decomp.html#module-linalg.svd_arnoldi">Partial SVD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../linalg/spec_decomp.html#module-linalg.svd_rsvd">Randomized SVD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../linalg/spec_decomp.html#module-linalg.eig_sym">Symmetric Eigendecomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../linalg/spec_decomp.html#module-linalg.eig_arnoldi">Partial diagonalization</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">peps-torch</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for config</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="k">def</span> <span class="nf">_torch_version_check</span><span class="p">(</span><span class="n">version</span><span class="p">):</span>
    <span class="c1"># for version=&quot;X.Y.Z&quot; checks if current version is higher or equal to X.Y</span>
    <span class="k">assert</span> <span class="n">version</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">version</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span><span class="s2">&quot;Invalid version string&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pkg_resources</span>
        <span class="k">return</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">parse_version</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">parse_version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">packaging</span> <span class="kn">import</span> <span class="n">version</span>
            <span class="k">return</span> <span class="n">version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
            <span class="n">tokens</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">tokens_v</span><span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">tokens_v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">tokens_v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tokens_v</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> 
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">get_args_parser</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">allow_abbrev</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--omp_cores&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;number of OpenMP cores&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--instate&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Input state JSON&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--instate_noise&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;magnitude of noise added to the trial </span><span class="se">\&quot;</span><span class="s2">instate</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--ipeps_init_type&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;RANDOM&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;initialization of the trial iPEPS state&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--out_prefix&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Output files prefix&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--bond_dim&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;iPEPS auxiliary bond dimension&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--chi&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;environment bond dimension&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--opt_max_iter&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;maximal number of epochs&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--opt_resume&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;file with checkpoint to resume&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--opt_resume_override_params&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;override optimizer parameters stored in checkpoint&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--seed&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;PRNG seed&quot;</span><span class="p">)</span>

    <span class="n">configs</span><span class="o">=</span><span class="p">[</span><span class="n">global_args</span><span class="p">,</span> <span class="n">peps_args</span><span class="p">,</span> <span class="n">ctm_args</span><span class="p">,</span> <span class="n">opt_args</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">:</span>
        <span class="n">group_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">group_prefix</span><span class="o">=</span><span class="n">group_name</span><span class="o">+</span><span class="s2">&quot;_&quot;</span> 
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="n">group_prefix</span><span class="p">)</span>
        <span class="n">c_list</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span> <span class="nb">dir</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="c1"># default is False</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">):</span> 
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="o">+</span><span class="n">group_prefix</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">)</span>
                <span class="c1"># default is True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="o">+</span><span class="n">group_prefix</span><span class="o">+</span><span class="s2">&quot;no_&quot;</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_false&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">group_prefix</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="o">+</span><span class="n">group_prefix</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">)),</span> <span class="n">default</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">parser</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">):</span>
    <span class="n">configs</span><span class="o">=</span><span class="p">[</span><span class="n">global_args</span><span class="p">,</span> <span class="n">peps_args</span><span class="p">,</span> <span class="n">ctm_args</span><span class="p">,</span> <span class="n">opt_args</span><span class="p">]</span>
    <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">]</span>
    <span class="n">conf_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">configs</span><span class="p">))</span>

    <span class="n">raw_args</span><span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">,</span><span class="n">x</span><span class="p">)),</span>\
        <span class="nb">dir</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">)))</span>
    <span class="n">grouped_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,[[]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">))]))</span>
    <span class="n">nogroup_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_search_keys</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span> <span class="k">return</span> <span class="n">k</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">raw_args</span><span class="p">:</span>
        <span class="n">ind</span><span class="o">=</span> <span class="n">_search_keys</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grouped_args</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nogroup_args</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># set prefix args</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">g_args</span> <span class="ow">in</span> <span class="n">grouped_args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">g_args</span><span class="p">:</span>
            <span class="c1"># strip prefix key+&quot;_&quot;</span>
            <span class="n">a_noprefix</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">):]</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">conf_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">a_noprefix</span><span class="p">,</span><span class="nb">getattr</span><span class="p">(</span><span class="n">parsed_args</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
    <span class="c1"># set main args</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">nogroup_args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">main_args</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

    <span class="c1"># custom handling</span>
    <span class="k">if</span> <span class="n">global_args</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s2">&quot;float64&quot;</span><span class="p">:</span>
        <span class="n">global_args</span><span class="o">.</span><span class="n">torch_dtype</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float64</span>
    <span class="k">elif</span> <span class="n">global_args</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="s2">&quot;complex128&quot;</span><span class="p">:</span>
        <span class="n">global_args</span><span class="o">.</span><span class="n">torch_dtype</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">complex128</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported dtype </span><span class="si">{</span><span class="n">global_args</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># validate</span>
    <span class="c1"># if ctm_args.step_core_gpu:</span>
    <span class="c1">#     assert global_args.gpu and torch.cuda.device(global_args.gpu), &quot;CTMARGS_step_core_gpu&quot;\</span>
    <span class="c1">#         +&quot; resquested without providing valid GLOBALARGS_gpu&quot;</span>

    <span class="c1"># set up logger</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">main_args</span><span class="o">.</span><span class="n">out_prefix</span><span class="o">+</span><span class="s2">&quot;.log&quot;</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_config</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PyTorch: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">scipy</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy: </span><span class="si">{</span><span class="n">scipy</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy: N/A&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">subprocess</span>
        <span class="kn">import</span> <span class="nn">pathlib</span>
        <span class="n">root_dir</span><span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="n">ret</span><span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cd </span><span class="si">{</span><span class="n">root_dir</span><span class="si">}</span><span class="s2"> ; git rev-parse --short HEAD&quot;</span><span class="p">,</span>\
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;peps-torch git ref: </span><span class="si">{</span><span class="n">ret</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;peps-torch git ref: N/A&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">subprocess</span>
        <span class="kn">import</span> <span class="nn">pathlib</span>
        <span class="n">root_dir</span><span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="n">ret</span><span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cd </span><span class="si">{</span><span class="n">root_dir</span><span class="si">}</span><span class="s2">/yast ; git rev-parse --short HEAD&quot;</span><span class="p">,</span>\
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;yast git ref: </span><span class="si">{</span><span class="n">ret</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;yast git ref: N/A&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">main_args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">global_args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">peps_args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ctm_args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">opt_args</span><span class="p">)</span>

<div class="viewcode-block" id="MAINARGS"><a class="viewcode-back" href="../config.html#config.MAINARGS">[docs]</a><span class="k">class</span> <span class="nc">MAINARGS</span><span class="p">():</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main simulation options. The default settings can be modified through </span>
<span class="sd">    command line arguments as follows ``--&lt;option-name&gt; desired-value``</span>

<span class="sd">    :ivar omp_cores: number of OpenMP cores. Default: ``1``</span>
<span class="sd">    :vartype omp_cores: int:</span>
<span class="sd">    :ivar instate: input state file. Default: ``None``</span>
<span class="sd">    :vartype instate: str or Path</span>
<span class="sd">    :ivar instate_noise: magnitude of noise applied to the input state, if any. Default: ``0.0``</span>
<span class="sd">    :vartype instate_noise: float</span>
<span class="sd">    :ivar ipeps_init_type: initialization of the trial iPEPS state, if no ``instate`` is provided. Default: ``RANDOM``</span>
<span class="sd">    :vartype ipeps_init_type: str</span>
<span class="sd">    :ivar out_prefix: output file prefix. Default: ``output``</span>
<span class="sd">    :vartype out_prefix: str</span>
<span class="sd">    :ivar bond_dim: iPEPS auxiliary bond dimension. Default: ``1``</span>
<span class="sd">    :vartype bond_dim: int</span>
<span class="sd">    :ivar chi: environment bond dimension. Default: ``20``</span>
<span class="sd">    :vartype chi: int</span>
<span class="sd">    :ivar opt_max_iter: maximal number of optimization steps. Default: ``100``</span>
<span class="sd">    :vartype opt_max_iter: int</span>
<span class="sd">    :ivar opt_resume: resume from checkpoint file. Default: ``None``</span>
<span class="sd">    :vartype opt_resume: str or Path</span>
<span class="sd">    :ivar opt_resume_override_params: override optimizer parameters stored in checkpoint. Default: ``False``</span>
<span class="sd">    :vartype opt_resume_override_params: bool</span>
<span class="sd">    :ivar seed: PRNG seed. Default: ``0``</span>
<span class="sd">    :vartype seed: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
            <span class="n">res</span><span class="o">+=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">= </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="GLOBALARGS"><a class="viewcode-back" href="../config.html#config.GLOBALARGS">[docs]</a><span class="k">class</span> <span class="nc">GLOBALARGS</span><span class="p">():</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Holds global configuration options. The default settings can be modified through </span>
<span class="sd">    command line arguments as follows ``--GLOBALARGS_&lt;variable-name&gt; desired-value``</span>

<span class="sd">    :ivar dtype: data type of all torch.tensor. Default: ``float64``</span>
<span class="sd">    :vartype dtype: torch.dtype</span>
<span class="sd">    :ivar device: device on which all the torch.tensors are stored. Default: ``&#39;cpu&#39;``</span>
<span class="sd">    :vartype device: str</span>
<span class="sd">    :ivar offload_to_gpu: gpu used for optional acceleration. It might be desirable to store the model </span>
<span class="sd">               and all the intermediates of CTM on CPU and compute only the core parts of the expensive</span>
<span class="sd">               CTM step on GPU. Default: ``&#39;None&#39;``</span>
<span class="sd">    :vartype offload_to_gpu: str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tensor_io_format</span><span class="o">=</span> <span class="s2">&quot;legacy&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">=</span> <span class="s2">&quot;float64&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">torch_dtype</span><span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float64</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offload_to_gpu</span><span class="o">=</span> <span class="s1">&#39;None&#39;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
            <span class="n">res</span><span class="o">+=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">= </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<span class="k">class</span> <span class="nc">PEPSARGS</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_dl</span><span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_dl_open</span><span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
            <span class="n">res</span><span class="o">+=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">= </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<div class="viewcode-block" id="CTMARGS"><a class="viewcode-back" href="../config.html#config.CTMARGS">[docs]</a><span class="k">class</span> <span class="nc">CTMARGS</span><span class="p">():</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Holds configuration of the CTM algorithm. The default settings can be modified through </span>
<span class="sd">    command line arguments as follows ``--CTMARGS_&lt;variable-name&gt; desired-value``</span>

<span class="sd">    :ivar ctm_max_iter: maximum iterations of directional CTM algorithm. Default: ``50``</span>
<span class="sd">    :vartype ctm_max_iter: int</span>
<span class="sd">    :ivar ctm_env_init_type: default initialization method for ENV objects. Default: ``&#39;CTMRG&#39;``</span>
<span class="sd">    :vartype ctm_env_init_type: str</span>
<span class="sd">    :ivar ctm_conv_tol: threshold for convergence of CTM algorithm. Default: ``&#39;1.0e-10&#39;``</span>
<span class="sd">    :vartype ctm_conv_tol: float</span>
<span class="sd">    :ivar conv_check_cpu: execute CTM convergence check on cpu (if applicable). Default: ``False`` </span>
<span class="sd">    :ivar ctm_absorb_normalization: normalization to use for new corner/T tensors. Either ``&#39;fro&#39;`` for usual</span>
<span class="sd">                                    L2 norm or ``&#39;inf&#39;`` for L-\infty norm. Default: ``&#39;fro&#39;``.  </span>
<span class="sd">    :vartype ctm_absorb_normalization: str</span>
<span class="sd">    :vartype conv_check_cpu: bool</span>
<span class="sd">    :ivar projector_method: method used to construct projectors which facilitate truncation</span>
<span class="sd">                            of environment bond dimension :math:`\chi` within CTM algorithm</span>

<span class="sd">                                * 4X4: Projectors are built from two halfs of 4x4 tensor</span>
<span class="sd">                                  network</span>
<span class="sd">                                * 4X2: Projectors are built from two enlarged corners (2x2)</span>
<span class="sd">                                  making up a 4x2 (or 2x4) tensor network</span>

<span class="sd">                            Default: ``&#39;4X4&#39;``  </span>
<span class="sd">    :vartype projector_method: str</span>
<span class="sd">    :ivar projector_svd_method: singular/eigen value decomposition algorithm used in the construction</span>
<span class="sd">                                of the projectors:</span>

<span class="sd">                                    * ``&#39;GESDD&#39;``: pytorch wrapper of LAPACK&#39;s gesdd</span>
<span class="sd">                                    * ``&#39;RSVD&#39;``: randomized SVD</span>
<span class="sd">                                    * ``&#39;SYMEIG&#39;``: pytorch wrapper of LAPACK&#39;s dsyev for symmetric matrices</span>
<span class="sd">                                    * ``&#39;SYMARP&#39;``: scipy wrapper of ARPACK&#39;s dsaupd for symmetric matrices</span>
<span class="sd">                                    * ``&#39;ARP&#39;``: scipy wrapper of ARPACK&#39;s svds for general matrices</span>

<span class="sd">                                Default: ``&#39;SYMEIG&#39;`` for c4v-symmetric CTM, otherwise ``&#39;GESDD&#39;``</span>
<span class="sd">    :vartype projector_svd_method: str</span>
<span class="sd">    :ivar projector_svd_reltol: relative threshold on the magnitude of the smallest elements of </span>
<span class="sd">                                singular value spectrum used in the construction of projectors. </span>
<span class="sd">                                Default: ``1.0e-8``</span>
<span class="sd">    :vartype projector_svd_reltol: float</span>
<span class="sd">    :ivar projector_svd_reltol_block: (relevant only for decompositions of blocks-sparse tensors) </span>
<span class="sd">                                relative threshold on the magnitude of the smallest elements of </span>
<span class="sd">                                singular value spectrum per block used in the construction of projectors.</span>
<span class="sd">                                Default: ``0.0``</span>
<span class="sd">    :vartype projector_svd_reltol_block: float</span>
<span class="sd">    :ivar projector_eps_multiplet: threshold for defining boundary of the multiplets</span>
<span class="sd">    :vartype projector_eps_multiplet: float</span>
<span class="sd">    :ivar projector_multiplet_abstol: absolute threshold for spectral values to be considered in multiplets </span>
<span class="sd">    :vartype projector_multiplet_abstol: float</span>
<span class="sd">    :ivar ctm_move_sequence: sequence of directional moves within single CTM iteration. The possible </span>
<span class="sd">                             directions are encoded as tuples(int,int) </span>
<span class="sd">                                </span>
<span class="sd">                                * up = (0,-1)</span>
<span class="sd">                                * left = (-1,0)</span>
<span class="sd">                                * down = (0,1)</span>
<span class="sd">                                * right = (1,0)</span>

<span class="sd">                             Default: ``[(0,-1), (-1,0), (0,1), (1,0)]``</span>
<span class="sd">    :vartype ctm_move_sequence: list[tuple(int,int)]</span>
<span class="sd">    :ivar ctm_force_dl: precompute and use on-site double-layer tensors in CTMRG </span>
<span class="sd">    :vartype ctm_force_dl: bool</span>
<span class="sd">    :ivar fwd_checkpoint_c2x2: recompute forward pass of enlarged corner functions (c2x2_*) during </span>
<span class="sd">                               backward pass within optimization to save memory. Default: ``False``</span>
<span class="sd">    :vartype fwd_checkpoint_c2x2: bool</span>
<span class="sd">    :ivar fwd_checkpoint_halves: recompute forward pass of halves functions (halves_of_4x4_*) during </span>
<span class="sd">                                 backward pass within optimization to save memory. Default: ``False``</span>
<span class="sd">    :vartype fwd_checkpoint_halves: bool</span>
<span class="sd">    :ivar fwd_checkpoint_projectors: recompute forward pass of projector construction (except SVD) during </span>
<span class="sd">                                     backward pass within optimization to save memory. Default: ``False``</span>
<span class="sd">    :vartype fwd_checkpoint_projectors: bool</span>
<span class="sd">    :ivar fwd_checkpoint_absorb: recompute forward pass of absorp and truncate functions (absorb_truncate_*) </span>
<span class="sd">                                 during backward pass within optimization to save memory. Default: ``False``</span>
<span class="sd">    :vartype fwd_checkpoint_absorb: bool</span>
<span class="sd">    :ivar fwd_checkpoint_move: recompute forward pass of whole ``ctm_MOVE`` during backward pass. Default: ``False``</span>
<span class="sd">    :vartype fwd_checkpoint_move: bool</span>

<span class="sd">    FPCM related options</span>

<span class="sd">    :ivar fpcm_init_iter: minimal number of CTM steps before FPCM acceleration step is attempted.</span>
<span class="sd">                          Default: ``1``</span>
<span class="sd">    :vartype fpcm_init_iter: int</span>
<span class="sd">    :ivar fpcm_freq: frequency of FPCM steps per CTM steps. Default: ``-1``</span>
<span class="sd">    :vartype fpcm_freq: int</span>
<span class="sd">    :ivar fpcm_isogauge_tol: tolerance on gauging the uniform MPS built from half-row/-column tensor T.</span>
<span class="sd">                             Default: ``1.0e-14``.</span>
<span class="sd">    :vartype fpcm_isogauge_tol: float</span>
<span class="sd">    :ivar fpcm_fpt_tol: tolerance on convergence within FPCM step. Default: ``1.0e-8``</span>
<span class="sd">    :vartype fpcm_fpt_tol: float</span>

<span class="sd">    Logging and Debugging options</span>

<span class="sd">    :ivar ctm_logging: log debug statements into log file. Default: ``False`` </span>
<span class="sd">    :vartype ctm_loggging: bool</span>
<span class="sd">    :ivar verbosity_initialization: verbosity of initialization method for ENV objects. Default: ``0``</span>
<span class="sd">    :vartype verbosity_initialization: int</span>
<span class="sd">    :ivar verbosity_ctm_convergence: verbosity of evaluation of CTM convergence criterion. Default: ``0``</span>
<span class="sd">    :vartype verbosity_ctm_convergence: int</span>
<span class="sd">    :ivar verbosity_projectors: verbosity of projector construction. Default: ``0``</span>
<span class="sd">    :vartype verbosity_projectors: int</span>
<span class="sd">    :ivar verbosity_ctm_move: verbosity of directional CTM moves. Default: ``0``</span>
<span class="sd">    :vartype verbosity_ctm_move: int</span>
<span class="sd">    :ivar verbosity_rdm: verbosity of reduced density matrix routines. Default: ``0``</span>
<span class="sd">    :vartype verbosity_rdm: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_max_iter</span><span class="o">=</span> <span class="mi">50</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_env_init_type</span><span class="o">=</span> <span class="s1">&#39;CTMRG&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_conv_tol</span><span class="o">=</span> <span class="mf">1.0e-8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_absorb_normalization</span><span class="o">=</span> <span class="s1">&#39;inf&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fpcm_init_iter</span><span class="o">=</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fpcm_freq</span><span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fpcm_isogauge_tol</span><span class="o">=</span> <span class="mf">1.0e-14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fpcm_fpt_tol</span><span class="o">=</span> <span class="mf">1.0e-8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv_check_cpu</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector_method</span> <span class="o">=</span> <span class="s1">&#39;4X4&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector_svd_method</span> <span class="o">=</span> <span class="s1">&#39;DEFAULT&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector_svd_reltol</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector_svd_reltol_block</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector_eps_multiplet</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projector_multiplet_abstol</span> <span class="o">=</span> <span class="mf">1.0e-14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ad_decomp_reg</span><span class="o">=</span> <span class="mf">1.0e-12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_move_sequence</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_force_dl</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctm_logging</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_initialization</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_ctm_convergence</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_projectors</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_ctm_move</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_fpcm_move</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_rdm</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fwd_checkpoint_c2x2</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fwd_checkpoint_halves</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fwd_checkpoint_projectors</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fwd_checkpoint_absorb</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fwd_checkpoint_move</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
            <span class="n">res</span><span class="o">+=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">= </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="OPTARGS"><a class="viewcode-back" href="../config.html#config.OPTARGS">[docs]</a><span class="k">class</span> <span class="nc">OPTARGS</span><span class="p">():</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Holds configuration of the optimization. The default settings can be modified through </span>
<span class="sd">    command line arguments as follows ``--OPTARGS_&lt;variable-name&gt; desired-value``</span>

<span class="sd">    General options</span>

<span class="sd">    :ivar opt_ctm_reinit: reinitialize environment from scratch within every loss </span>
<span class="sd">                          function evaluation. Default: ``True``</span>
<span class="sd">    :vartype opt_ctm_reinit: bool</span>
<span class="sd">    :ivar lr: initial learning rate. Default: ``1.0``</span>
<span class="sd">    :vartype lr: float</span>
<span class="sd">    :ivar line_search: line search algorithm to use. L-BFGS supports ``&#39;strong_wolfe&#39;`` </span>
<span class="sd">        and ``&#39;backtracking&#39;``. SGD supports just ``&#39;backtracking&#39;``. Default: ``None``.</span>
<span class="sd">    :vartype line_search: str</span>
<span class="sd">    :ivar line_search_ctm_reinit: recompute environment from scratch at each step within</span>
<span class="sd">        line search algorithm. Default: ``True``.</span>
<span class="sd">    :vartype line_search_ctm_reinit: bool</span>
<span class="sd">    :ivar line_search_svd_method:   eigen decompostion method to use within line search</span>
<span class="sd">        environment computation. See options in :class:`config.CTMARGS`. Default: ``&#39;DEFAULT&#39;`` which</span>
<span class="sd">        depends on the particular CTM algorithm.</span>
<span class="sd">    :vartype line_search_svd_method: str</span>
<span class="sd">    </span>
<span class="sd">    L-BFGS related options</span>

<span class="sd">    :ivar tolerance_grad: stopping criterion wrt. norm of the gradient (which norm ? See </span>
<span class="sd">                          ``torch.optim.LBFGS``). Default: ``1.0e-5``</span>
<span class="sd">    :vartype tolerance_grad: float</span>
<span class="sd">    :ivar tolerance_change: stopping criterion wrt. change of the loss function. </span>
<span class="sd">                            Default: ``1.0e-9``</span>
<span class="sd">    :vartype tolerance_change: float</span>
<span class="sd">    :ivar max_iter_per_epoch: maximum number of optimizer iterations per epoch. Default: ``1``</span>
<span class="sd">    :vartype max_iter_per_epoch: int</span>
<span class="sd">    :ivar history_size: number past of directions used to approximate inverse Hessian.</span>
<span class="sd">        Default: ``100``.</span>
<span class="sd">    :vartype history_size: int </span>
<span class="sd">    </span>
<span class="sd">    SGD related options</span>

<span class="sd">    :ivar momentum: momentum used in the SGD step</span>
<span class="sd">    :vartype momentum: float</span>
<span class="sd">    :ivar dampening: dampening used in the SGD step</span>
<span class="sd">    :vartype dampening: float</span>

<span class="sd">    Gradients through finite differences</span>

<span class="sd">    :ivar fd_eps: magnitude of displacement when computing the forward difference </span>
<span class="sd">        :math:`E(x_0 + \textrm{fd_eps})-E(x_0)/\textrm{fd_eps}`. Default: ``1.0e-4``</span>
<span class="sd">    :vartype fd_eps: float</span>
<span class="sd">    :ivar fd_ctm_reinit: recompute environment from scratch after applying the displacement.</span>
<span class="sd">        Default: ``True`` </span>

<span class="sd">    Logging</span>

<span class="sd">    :ivar opt_logging: turns on recording of additional data from optimization, such as</span>
<span class="sd">                       CTM convergence, timings, gradients, etc. The information </span>
<span class="sd">                       is logged in file ``{out_prefix}_log.json``. Default: ``True``</span>
<span class="sd">    :vartype opt_logging: bool</span>
<span class="sd">    :ivar opt_log_grad: log values of gradient. Default: ``False``</span>
<span class="sd">    :vartype opt_log_grad: bool</span>
<span class="sd">    :ivar verbosity_opt_epoch: verbosity within optimization epoch. Default: ``1``</span>
<span class="sd">    :vartype verbosity_opt_epoch: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">momentum</span><span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dampening</span><span class="o">=</span> <span class="mf">0.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_grad</span><span class="o">=</span> <span class="mf">1e-5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_change</span><span class="o">=</span> <span class="mf">1e-9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_ctm_reinit</span><span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_search</span><span class="o">=</span> <span class="s2">&quot;default&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_search_ctm_reinit</span><span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_search_svd_method</span><span class="o">=</span> <span class="s1">&#39;DEFAULT&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_search_tol</span><span class="o">=</span> <span class="mf">1.0e-8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fd_eps</span><span class="o">=</span> <span class="mf">1.0e-4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fd_ctm_reinit</span><span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span><span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iter_per_epoch</span><span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity_opt_epoch</span><span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_logging</span><span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_log_grad</span><span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="p">,</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">))):</span>
            <span class="n">res</span><span class="o">+=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">= </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<span class="n">main_args</span><span class="o">=</span> <span class="n">MAINARGS</span><span class="p">()</span>
<span class="n">global_args</span><span class="o">=</span> <span class="n">GLOBALARGS</span><span class="p">()</span>
<span class="n">peps_args</span><span class="o">=</span> <span class="n">PEPSARGS</span><span class="p">()</span>
<span class="n">ctm_args</span><span class="o">=</span> <span class="n">CTMARGS</span><span class="p">()</span>
<span class="n">opt_args</span><span class="o">=</span> <span class="n">OPTARGS</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Juraj Hasik, Glen B. Mbeng

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>